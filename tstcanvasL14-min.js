"use strict";!function(){var t=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t,i){window.setTimeout(t,1e3/60)},i=document.getElementById("screen2").getContext("2d"),h={width:document.getElementById("screen2").width,height:document.getElementById("screen2").height},e={current:0,titles:0,main:1,over:2},s=0,a=0,o=0,r=0,n=0,l=0,d=0,g=60,m=60,f=60,y=40,c=60,w=2,u=17,x=5,b=5,M=!1,p=!1,v=20,k=0,T=6,I=32,S="rgba( 80, 48,122,1)",P="rgba(137,102,184,1)",R="rgba(180,122, 61,1)",C="rgba(158, 89, 17,1)",O="rgba(109, 56,  0,1)",A="rgba( 41, 95,113,1)",E="rgba(151,195,209,1)",L="rgba( 14, 77, 99,1)",j="rgba(180,169, 61,1)",B="rgba(255,248,181,1)",z="rgba(158,145, 17,1)",V="rgba(109, 99,  0,1)",H={};function J(t){return!0===H[t]}function q(t,i,h,e){this.x=t,this.y=i,this.width=h,this.height=e,this.dy=0,this.dyIni=-8,this.grav=.8,this.accy=5,this.doubleJump=!1,this.rotateSpeed=0,this.states={current:0,normal:0,jump:1}}function F(t,i,h,e,s){this.x=-30,this.y=-30,this.xIni=t,this.yIni=i,this.width=h,this.height=e,this.color=s||"black",this.moving=!1,this.splashed=!1,this.animTick=1,this.anim1Length=60,this.collided=!1}function X(){this.x=gt.x+gt.width-10,this.y=gt.y+gt.height-10,this.grav=.8,this.moving=!0,this.life=60-Math.floor(50*Math.random()),this.dx=0,this.dy=0}function Y(){this.x=-40,this.y=0,this.grav=-.2,this.moving=!0,this.life=Math.floor(50*Math.random()),this.dx=0,this.dy=0}function D(){this.x=-50,this.y=gt.y+gt.height+4*Math.random(),this.moving=!1}function G(){this.x=-50,this.y=h.height-85,this.moving=!1}function K(){this.x=-50,this.y=-50,this.dy=-Math.max(10*Math.random(),5),this.dx=Math.min(20*Math.random(),10),this.grav=.2,this.moving=!1,this.life=50,this.width=10,this.height=10}function N(){for(var t=0;t<ut.length;t++)ut[t].draw(),ut[t].update()}function Q(){for(var t=0;t<ft.length;t++)ft[t].draw(),ft[t].update();for(t=0;t<yt.length;t++)yt[t].draw(),yt[t].update();for(t=0;t<ct.length;t++)ct[t].draw(),ct[t].update()}function U(){gt.draw(),gt.updatePos()}function W(){(nt-=1)+640<=0&&(nt=0),(lt-=.6)+640<=0&&(lt=0),i.save(),i.fillStyle=E,i.fillRect(-20,-20,h.width+40,h.height+40),i.globalAlpha=.1,l<30&&!p?(i.save(),i.globalAlpha=l/30*.1,i.drawImage(tt,0,0,640,96,nt,h.height-160+100*(1-Math.pow(l/30,3))*2,640,96),i.drawImage(tt,0,0,640,96,nt+640,h.height-160+100*(1-Math.pow(l/30,3))*2,640,96),i.drawImage(tt,0,96,640,100,lt,0+100*(1-Math.pow(l/30,3))*2,640,100),i.drawImage(tt,0,96,640,100,lt+640,0+100*(1-Math.pow(l/30,3))*2,640,100),i.restore()):(i.drawImage(tt,0,0,640,96,nt,h.height-160,640,96),i.drawImage(tt,0,0,640,96,nt+640,h.height-160,640,96),i.drawImage(tt,0,96,640,100,lt,0,640,100),i.drawImage(tt,0,96,640,100,lt+640,0,640,100)),i.restore()}function Z(){switch((ot-=T)+640<=0&&(ot=0),(rt-=T-1)+640<=0&&(rt=0),(dt-=T)+640<=0&&(dt=0),e.current){case e.main:l<30&&!p?(i.drawImage(_,0,0,640,48,rt+640,h.height-115+100*(1-Math.pow(l/30,3))*2,640,48),i.drawImage(_,0,0,640,48,rt,h.height-115+100*(1-Math.pow(l/30,3))*2,640,48),i.fillStyle=V,i.fillRect(-20,h.height-90+100*(1-Math.pow(l/30,3))*2,h.width+40,130),i.fillStyle=j,i.fillRect(-20,h.height-90+100*(1-Math.pow(l/30,3))*2,h.width+40,20),i.drawImage(_,0,0,640,48,dt+640,h.height-87+100*(1-Math.pow(l/30,3))*2,640,48),i.drawImage(_,0,0,640,48,dt,h.height-87+100*(1-Math.pow(l/30,3))*2,640,48),i.save(),i.shadowColor="rgba(10, 10, 10, 0.3)",i.shadowOffsetX=-4,i.shadowOffsetY=-1,i.shadowBlur=6,i.drawImage(_,0,48,640,48,ot+640,h.height-110+100*(1-Math.pow(l/30,3))*2,640,48),i.drawImage(_,0,48,640,48,ot,h.height-110+100*(1-Math.pow(l/30,3))*2,640,48),i.restore()):(i.save(),i.drawImage(_,0,0,640,48,rt+640,h.height-115,640,48),i.drawImage(_,0,0,640,48,rt,h.height-115,640,48),i.fillStyle=V,i.fillRect(-20,h.height-90,h.width+40,130),i.fillStyle=j,i.fillRect(-20,h.height-90,h.width+40,20),i.drawImage(_,0,0,640,48,dt+640,h.height-87,640,48),i.drawImage(_,0,0,640,48,dt,h.height-87,640,48),i.save(),i.shadowColor="rgba(10, 10, 10, 0.3)",i.shadowOffsetX=-4,i.shadowOffsetY=-1,i.shadowBlur=6,i.drawImage(_,0,48,640,48,ot+640,h.height-110,640,48),i.drawImage(_,0,48,640,48,ot,h.height-110,640,48),i.restore(),i.restore()),l++;break;case e.over:i.save(),i.drawImage(_,0,0,640,48,rt+640,h.height-115,640,48),i.drawImage(_,0,0,640,48,rt,h.height-115,640,48),i.fillStyle=V,i.fillRect(-20,h.height-90,h.width+40,130),i.fillStyle=j,i.fillRect(-20,h.height-90,h.width+40,20),i.drawImage(_,0,0,640,48,dt+640,h.height-87,640,48),i.drawImage(_,0,0,640,48,dt,h.height-87,640,48),i.save(),i.shadowColor="rgba(10, 10, 10, 0.3)",i.shadowOffsetX=-4,i.shadowOffsetY=-1,i.shadowBlur=6,i.drawImage(_,0,48,640,48,ot+640,h.height-110,640,48),i.drawImage(_,0,48,640,48,ot,h.height-110,640,48),i.restore(),i.restore();break}}document.onkeydown=function(t){H[t.keyCode]=!0},document.onkeyup=function(t){H[t.keyCode]=!1},q.prototype={setState:function(t){this.states.current=this.states[t]},updatePos:function(){switch(this.states.current){case this.states.normal:if(this.y=e.current===e.main?h.height-110-2*Math.sin(r):h.height-110-2*Math.sin(r/5),this.dy=this.dyIni,this.accy=2,this.jumpCount=5,this.doubleJump=!1,J(I)&&e.current!==e.over){for(ht=0;ht<it.length;ht++)if(0===it[ht].currentTime||it[ht].ended){it[ht].play();break}this.setState("jump"),this.dy=this.dyIni}break;case this.states.jump:if(J(I)&&0===this.jumpCount&&!this.doubleJump){for(ht=0;ht<it.length;ht++)if(0===it[ht].currentTime||it[ht].ended){it[ht].play();break}this.doubleJump=!0,this.rotateSpeed=Math.max(5,Math.floor(20*Math.random())),this.dy=this.dyIni,this.accy=1.7}this.dy>=0?(this.y-=this.dy*this.accy,this.dy+=this.grav,this.accy-=.1,H[I]=!1,this.y+this.height>h.height-100&&this.setState("normal")):this.dy<0&&(this.jumpCount>0&&(this.y+=this.dy,this.jumpCount-=1),(this.jumpCount<=0||!J(I))&&(this.y+=this.dy*this.accy,this.dy+=this.grav,H[I]=!1,this.accy-=.1));break}},draw:function(){switch(s+=.07,i.save(),i.shadowColor="rgba(10, 10, 10, 0.3)",i.shadowOffsetX=-4,i.shadowOffsetY=-1,i.shadowBlur=6,p||(i.globalAlpha=l<30?l/30:1),this.states.current){case this.states.normal:e.current!==e.over?(0!==o?(i.fillStyle="rgba(183, 159, 216,"+Math.abs(Math.sin(s*(Math.PI/2)))+")",i.fillRect(this.x-4*Math.random(),this.y-3*Math.floor(Math.random())+3,this.width+3,this.height-3)):(i.fillStyle=L,i.fillRect(this.x,this.y+3,this.width+3,this.height-3)),Math.random()>.9923||!1!==this.closedEyes?this.closeCount>0?(this.closedEyes=!0,i.beginPath(),i.moveTo(this.x+7,this.y+10),i.lineTo(this.x+17,this.y+10),i.strokeStyle="rgba(10,10,10,1)",i.stroke(),i.beginPath(),i.moveTo(this.x+this.width-5,this.y+10),i.lineTo(this.x+this.width-15,this.y+10),i.strokeStyle="rgba(10,10,10,1)",i.stroke(),this.closeCount-=1):this.closedEyes=!1:(i.fillStyle="rgba( 255, 255, 255, 0.99)",i.beginPath(),i.arc(this.x+18,this.y+10,4,-2/6*(2*Math.PI),2*Math.PI*.01,!0),i.fill(),i.beginPath(),i.arc(this.x+this.width-4,this.y+10,3,-1/6*(2*Math.PI),2*Math.PI*.49),i.fill(),this.closeCount=10)):(i.fillStyle=A,i.fillRect(this.x,this.y-3,this.width-3,this.height+3),Math.random()>.9923||!1!==this.closedEyes?this.closeCount>0?(this.closedEyes=!0,i.beginPath(),i.moveTo(this.x+7,this.y+10),i.lineTo(this.x+17,this.y+10),i.strokeStyle="rgba(10,10,10,1)",i.stroke(),i.beginPath(),i.moveTo(this.x+this.width-5,this.y+10),i.lineTo(this.x+this.width-15,this.y+10),i.strokeStyle="rgba(10,10,10,1)",i.stroke(),this.closeCount-=1):this.closedEyes=!1:(i.fillStyle="rgba( 255, 255, 255, 0.99)",i.beginPath(),i.arc(this.x+11,this.y+6,4,-1/6*(2*Math.PI),-2/3*(2*Math.PI)),i.fill(),i.beginPath(),i.arc(this.x+this.width-8,this.y+6,3,-2/6*(2*Math.PI),1/6*(2*Math.PI),!0),i.fill(),this.closeCount=10));break;case this.states.jump:i.save(),i.fillStyle="rgba(10, 10, 10, 0.1)",i.fillRect(this.x-15+gt.y/10,h.height-82,50-gt.y/5,10),i.fillRect(this.x-18+gt.y/10,h.height-82,50-gt.y/5+5,5),i.fillRect(this.x-15+gt.y/10,h.height-82,50-gt.y/5,10),i.restore(),this.doubleJump?(i.translate(this.x+this.width/2,this.y+this.height/2),i.rotate(Math.PI*(r/this.rotateSpeed)),i.translate(-(this.x+this.width/2),-(this.y+this.height/2))):(i.translate(this.x+this.width/2,this.y+this.height/2),i.rotate(Math.sin(r/10)/2),i.translate(-(this.x+this.width/2),-(this.y+this.height/2))),0!==o?(i.fillStyle="rgba(183, 159, 216,"+Math.abs(Math.sin(s*(Math.PI/2)))+")",i.fillRect(this.x-4*Math.random(),this.y-3*Math.floor(Math.random())-3,this.width-3,this.height+3)):(i.fillStyle=L,i.fillRect(this.x,this.y-3,this.width-3,this.height+3)),Math.random()>.9923||!1!==this.closedEyes?this.closeCount>0?(this.closedEyes=!0,i.beginPath(),i.moveTo(this.x+7,this.y+10),i.lineTo(this.x+17,this.y+10),i.strokeStyle="rgba(10,10,10,1)",i.stroke(),i.beginPath(),i.moveTo(this.x+this.width-5,this.y+10),i.lineTo(this.x+this.width-15,this.y+10),i.strokeStyle="rgba(10,10,10,1)",i.stroke(),this.closeCount-=1):this.closedEyes=!1:(i.fillStyle="rgba( 255, 255, 255, 0.99)",i.beginPath(),i.arc(this.x+11,this.y+6,4,0,2*Math.PI),i.fill(),i.beginPath(),i.arc(this.x+this.width-8,this.y+6,3,0,2*Math.PI),i.fill(),this.closeCount=10);break}i.restore()}},F.prototype={init:function(){this.x=-30,this.y=-30,this.moving=!1,this.splashed=!1,this.animTick=1,this.anim1Length=60,this.collided=!1},update:function(){mt.bodies.indexOf(this)<3?this.x-=T:(this.x-=T+3,this.y-=.9*Math.sin(r/2)),this.x+this.width+10<0&&(this.moving=!1,this.splashed=!1,this.collided=!1,this.animTick=1,this.x=this.xIni,mt.bodies.indexOf(this)<3?(mt.readyVer.splice(mt.bodies.indexOf(this),0,mt.bodies.indexOf(this)),this.y=this.yIni):(mt.readyHor.splice(mt.bodies.indexOf(this)-3,0,mt.bodies.indexOf(this)),this.y=this.yIni)),this.animTick+=2,this.animTick=Math.min(this.animTick,this.anim1Length),function(t,i){if(t.x<=i.x+i.width&&t.x+t.width>=i.x&&t.y<=i.y+i.height&&t.y+t.height>=i.y&&0===o)return o=100,a++,!0}(this,gt)&&(this.collided=!0)},draw:function(){i.save(),i.shadowColor="rgba(0, 0, 0, 0.4)",i.shadowOffsetX=-2,i.shadowOffsetY=-1,i.shadowBlur=6,i.fillStyle=this.color,mt.bodies.indexOf(this)<3?(i.save(),i.shadowColor="rgba(0, 0, 0, 0)",i.fillStyle=R,i.fillRect(this.x-5,h.height-85,gt.width,10),i.fillRect(this.x-8,h.height-83,gt.width+5,5),i.fillRect(this.x-5,h.height-85,gt.width,10),i.restore(),this.splashed&&60===this.animTick&&(i.globalAlpha=0),this.animTick<31?(i.beginPath(),i.moveTo(this.x,this.y+this.height),i.bezierCurveTo(this.x+Math.pow(this.animTick/17,3),this.y+this.height,this.x+Math.pow(this.animTick/17,3),this.y+this.height-(this.height+40)*Math.pow(this.animTick/(this.anim1Length-30),3),this.x,this.y+this.height-(this.height+40)*Math.pow(this.animTick/(this.anim1Length-30),3)),i.lineTo(this.x+this.width,this.y+this.height-(this.height+40)*Math.pow(this.animTick/(this.anim1Length-30),3)),i.bezierCurveTo(this.x+this.width-Math.pow(this.animTick/17,3),this.y+this.height-(this.height+40)*Math.pow(this.animTick/(this.anim1Length-30),3),this.x+this.width-Math.pow(this.animTick/17,3),this.y+this.height,this.x+this.width,this.y+this.height),i.fill(),i.drawImage(_,0,193,48,48,this.x+this.width/2-24,this.y+this.height-(this.height+40)*Math.pow(this.animTick/(this.anim1Length-30),3)-24,48,48)):this.animTick>30&&this.animTick<46?(i.beginPath(),i.moveTo(this.x,this.y+this.height),i.bezierCurveTo(this.x-(this.animTick-30)/2,this.y+this.height,this.x-(this.animTick-30)/2,this.y+this.height-(this.height+40)+50*(1-Math.pow((45-this.animTick)/15,3)),this.x,this.y+this.height-(this.height+40)+50*(1-Math.pow((45-this.animTick)/15,3))),i.lineTo(this.x+this.width,this.y+this.height-(this.height+40)+50*(1-Math.pow((45-this.animTick)/15,3))),i.bezierCurveTo(this.x+this.width+(this.animTick-30)/2,this.y+this.height-(this.height+40)+50*(1-Math.pow((45-this.animTick)/15,3)),this.x+this.width+(this.animTick-30)/2,this.y+this.height,this.x+this.width,this.y+this.height),i.fill(),i.drawImage(_,0,193,48,48,this.x+this.width/2-24,this.y+this.height-(this.height+40)+50*(1-Math.pow((45-this.animTick)/15,3))-24,48,48)):(i.beginPath(),i.moveTo(this.x,this.y+this.height),i.bezierCurveTo(this.x-7.5+(this.animTick-45)/2,this.y+this.height,this.x-7.5+(this.animTick-45)/2,this.y+this.height-(this.height-10)-20*Math.pow((this.animTick-45)/(this.anim1Length-45),3),this.x,this.y+this.height-(this.height-10)-20*Math.pow((this.animTick-45)/(this.anim1Length-45),3)),i.lineTo(this.x+this.width,this.y+this.height-(this.height-10)-20*Math.pow((this.animTick-45)/(this.anim1Length-45),3)),i.bezierCurveTo(this.x+this.width+7.5-(this.animTick-45)/2,this.y+this.height-(this.height-10)-20*Math.pow((this.animTick-45)/(this.anim1Length-45),3),this.x+this.width+7.5-(this.animTick-45)/2,this.y+this.height,this.x+this.width,this.y+this.height),i.fill(),i.drawImage(_,0,193,48,48,this.x+this.width/2-24,this.y+this.height-(this.height-10)-20*Math.pow((this.animTick-45)/(this.anim1Length-45),3)-24,48,48))):(i.fillRect(this.x,this.y,10,10),i.fillStyle="rgba(255,248,181,"+(this.x/h.width*1.2-.4)+")",i.fillRect(this.x+this.width+5,this.y+this.height/2-2,h.width/10+(h.width-this.x)/2,this.height/4),i.fillRect(this.x+this.width+5,this.y+this.height/2-2+5*Math.random(),20+this.x/1,this.height/4)),i.restore()}},X.prototype={update:function(){if(ft.indexOf(this)<100){if(!this.moving&&gt.states.current===gt.states.normal&&(l>30||p)&&e.current!==e.over){if(l<30&&!p)return;this.moving=!0,this.life=60-Math.floor(50*Math.random()),this.x=gt.x+gt.width-10,this.y=gt.y+gt.height,this.dy=12*-Math.random(),this.dx=12*Math.random()}!0===this.moving&&this.life>0?(this.x-=this.dx,this.y+=this.dy,this.dy+=this.grav,this.life--,this.y>h.height-80&&(this.dy*=-.4)):this.moving=!1}else if(ft.indexOf(this)>99){for(var t=0;t<3;t++)!this.moving&&1===w&&mt.bodies[t].moving&&mt.bodies[t].animTick<60&&(this.moving=!0,w=0,this.life=60-Math.floor(50*Math.random()),this.x=mt.bodies[t].x+mt.bodies[t].width/2,this.y=mt.bodies[t].y+mt.bodies[t].height,this.dx=T+Math.pow(-1,Math.floor(2*Math.random()))*Math.random()*6,this.dy=10*-Math.random());!0===this.moving&&this.life>0?(this.x-=this.dx,this.y+=this.dy,this.dy+=this.grav,this.life--,this.y>h.height-80&&(this.dy*=-.4)):this.moving=!1}},draw:function(){this.life>0&&!0===this.moving&&(i.save(),i.fillStyle=O,i.fillRect(this.x,this.y,this.life/6,this.life/6),i.restore())}},Y.prototype={update:function(){!1===this.moving&&0===u&&gt.states.current===gt.states.jump&&(u=gt.doubleJump?5:17,this.moving=!0),!0===this.moving&&this.life>0?(this.x-=this.dx+4*Math.random(),this.y+=this.dy,this.life--):(this.moving=!1,this.life=40+Math.floor(10*Math.random()),this.x=gt.x+gt.width/2,this.y=gt.y+gt.height,this.dy=0)},draw:function(){this.life>0&&!0===this.moving&&(i.save(),i.fillStyle="rgba(255, 255, 255,"+this.life/100+")",i.beginPath(),i.arc(this.x-10*Math.random(),this.y,this.life/6,50*Math.random(),2*Math.PI*(this.life/100)*2,!1),i.fill(),i.restore())}},D.prototype={update:function(){!1===this.moving&&5===x&&gt.states.current===gt.states.normal&&l>30&&(this.moving=!0,x=0,this.x=gt.x+gt.width/2,this.y=gt.y+gt.height,this.y=Math.max(this.y,h.height-85)),this.x-=T,this.x+40<0&&(this.moving=!1)},draw:function(){!0===this.moving&&(i.save(),i.fillStyle=R,i.fillRect(this.x,this.y,9,3),i.restore())}},G.prototype={update:function(){gt.states.current===gt.states.jump&&gt.dy>14&&gt.y>130&&20===b&&(this.moving=!0,b=0,v=20,this.x=gt.x+gt.width/2,this.y=h.height-85),this.x-=T,this.x+40<0&&(this.moving=!1)},draw:function(){!0===this.moving&&(i.save(),i.fillStyle=O,i.fillRect(this.x+5,h.height-85,gt.width+5,10),i.fillRect(this.x+5-3,h.height-83,gt.width+10,5),i.fillRect(this.x+5,h.height-85,gt.width+5,10),i.restore())}},K.prototype={update:function(){this.moving&&(this.x-=this.dx,this.y+=this.dy,this.dy+=this.grav),(this.x+50<0||this.y+20<0)&&(this.moving=!1,this.dy=-Math.max(10*Math.random(),5),this.life=50)},draw:function(){this.moving&&this.life>0&&l>30&&(i.save(),i.fillStyle=1+Math.floor(2*Math.random())===1?1+Math.floor(2*Math.random())===1?O:C:z,i.translate(this.x+this.width/2,this.y+this.height/2),i.rotate(Math.PI*(r/5)),i.fillRect(0,0,5+this.life/5,5+this.life/5),i.translate(-this.x-this.width/2,-this.y-this.height/2),i.restore(),this.life--)}};var $=new Image;$.src="titleScreen.png";var _=new Image;_.src="back1.png";var tt=new Image;tt.src="back2.png";for(var it=[],ht=0;ht<6;ht++)it.push(new Audio),it[ht].src="jump.mp3",it[ht].volume=.1;var et=[];for(ht=0;ht<6;ht++)et.push(new Audio),et[ht].src="boom.mp3",et[ht].volume=.1;var st=[];for(ht=0;ht<6;ht++)st.push(new Audio),st[ht].src="gun.mp3",st[ht].volume=.1;var at=new Audio;at.src="back1.mp3",at.play(),at.volume=.15,at.loop=!0;var ot=0,rt=0,nt=0,lt=0,dt=0,gt=new q(80,h.height,30,30),mt={bodies:[new F(h.width+80,h.height-80-40,20,40,C),new F(h.width+80,h.height-80-80,20,80,C),new F(h.width+80,h.height-80-140,20,140,C),new F(h.width+20,120,30,10,B),new F(h.width+20,180,30,10,B),new F(h.width+20,40,30,10,B)],readyVer:[0,1,2],readyHor:[3,4,5]},ft=[];for(ht=0;ht<200;ht++)ft.push(new X);var yt=[];for(ht=0;ht<25;ht++)yt.push(new Y);var ct=[];for(ht=0;ht<25;ht++)ct.push(new D);var wt=[];for(ht=0;ht<25;ht++)wt.push(new G);var ut=[];for(ht=0;ht<50;ht++)ut.push(new K);!function s(){switch(i.clearRect(-20,-20,h.width+40,h.height+40),e.current){case e.titles:i.fillStyle=E,i.fillRect(-20,-20,h.width+40,h.height+40),M||(n<=30?(i.drawImage($,0,300*(1-Math.pow(n/30,3))-40,640,300),n++):n>30&&n<=45?(i.drawImage($,0,50*(1-Math.pow((45-n)/15,3))-40,640,300),n++):n>45&&n<60&&(i.drawImage($,0,50*(1-Math.pow((n-46)/15,3))-40,640,300),n++),60===n&&(i.save(),i.drawImage($,0+5*Math.random(),5*Math.random()-40,640,300),i.font="30px score",i.fillStyle="white",i.globalAlpha=r%40<20?0:1,i.fillText("Click to start",h.width/2-128,.95*h.height),i.restore())),M&&(n>=60&&n<=63?(i.fillStyle="white",i.fillRect(0,0,h.width,h.height),n++):n>63&&n<=93?(i.drawImage($,0,0,640,300,0,100*Math.pow((n-63)/30,3)*2-30,640,300),n++):(M=!1,e.current=e.main)),60===n&&(document.onclick=function(){M=!0});break;case e.main:if(3===a&&(e.current=e.over),T=9+k/5,o>92)break;W(),function(){for(var t=!1,s=0;s<3;s++)mt.bodies[s].splashed&&(t=!0);i.save(),i.globalAlpha=l<30?l/30:1,i.fillStyle=A;for(var o=0;o<3-a;o++)i.fillRect(.03*h.width+30*o,.06*h.height,l<30?l/30*20:20,l<30?l/30*20:20);1===a&&g>0&&(i.save(),i.fillStyle="red",i.fillRect(.03*h.width+60,.06*h.height+200*Math.pow(5*(60-g)/60,3),20,20),g--,i.restore()),2===a&&m>0&&(i.save(),i.fillStyle="red",i.fillRect(.03*h.width+30,.06*h.height+200*Math.pow(5*(60-m)/60,3),20,20),m--,i.restore()),3===a&&f>0&&(i.save(),i.fillStyle="red",i.fillRect(.03*h.width+0,.06*h.height+200*Math.pow(5*(60-f)/60,3),20,20),f--,i.restore()),e.current===e.main&&(t?(i.font=60+r%10+"px score",i.fillStyle=1+Math.floor(2*Math.random())===1?1+Math.floor(2*Math.random())===1?B:P:S,i.translate(h.width-80,60),i.rotate(Math.sin(r/2)/2),i.translate(-(h.width-80),-60),i.fillText(k,h.width-100,60-10*Math.random())):(i.font="48px score",i.fillText(k,h.width-100,50))),i.restore()}(),v>0?(i.save(),i.translate(-Math.random()*(v/10),-Math.random()*v*2)):(i.save(),i.translate(2*-Math.random(),5*-Math.random())),Z(),U(),function(){for(var t=0;t<wt.length;t++)wt[t].draw(),wt[t].update()}(),function(){var t=Math.floor(3*Math.random()),i=Math.floor(3*Math.random());if(70===y&&(2===t&&void 0!==mt.bodies[mt.readyVer[t]]&&Math.random()>.999||2!==t&&void 0!==mt.bodies[mt.readyVer[t]]&&Math.random()>.9)&&(mt.bodies[mt.readyVer[t]].moving=!0,mt.readyVer.splice(t,1),y=0),Math.random()>.97&&40===c&&void 0!==mt.bodies[mt.readyHor[i]]){for(mt.bodies[mt.readyHor[i]].moving=!0,h=0;h<st.length;h++)if(0===st[h].currentTime||st[h].ended){st[h].play();break}mt.readyHor.splice(i,1),c=0}for(var h=0;h<mt.bodies.length;h++)mt.bodies[h].moving&&(mt.bodies[h].draw(),mt.bodies[h].update())}(),function(){for(var t=0;t<3;t++)if(!mt.bodies[t].splashed&&mt.bodies[t].moving&&mt.bodies[t].x<gt.x&&mt.bodies[t].y>gt.y&&!mt.bodies[t].collided){mt.bodies[t].splashed=!0,mt.bodies[t].animTick=46;for(var e=0;e<et.length;e++)if(0===et[e].currentTime||et[e].ended){et[e].play();break}i.fillStyle="rgba( 255, 255, 255, 0.5)",i.beginPath(),i.arc(mt.bodies[t].x+mt.bodies[t].width/2,h.height-80,70,0,Math.PI,!0),i.fill(),k+=1;for(var s=0;s<10;s++)for(e=0;e<mt.bodies[t].height/10*(mt.bodies[t].width/10);e++)ut[e].moving||(ut[e].moving=!0,ut[e].x=mt.bodies[t].x+10*Math.floor(e/(mt.bodies[t].height/10)),ut[e].y=mt.bodies[t].y+mt.bodies[t].height-10*(e-mt.bodies[t].height/10*Math.floor(e/(mt.bodies[t].height/10))))}}(),N(),Q(),i.restore();break;case e.over:T=d>=30&&d<60?3+d/30*4:3;for(var I=0;I<ft.length;I++)ft[I].x=-50;for(I=0;I<yt.length;I++)yt[I].x=-50;for(I=0;I<wt.length;I++)wt[I].x=-50;for(I=0;I<mt.bodies.length;I++)mt.bodies[I].x=-50;localStorage.getItem("myPb")<k&&localStorage.setItem("myPb",k.toString());for(I=0;I<mt.bodies.length;I++)mt.bodies[I].init();W(),Z(),U(),Q(),N(),i.restore(),i.save(),d<20&&(i.fillStyle="rgba(255,255,255,"+d/20+")",d++),d>=30&&d<60?(i.fillStyle="rgba(255,255,255,"+(1-(d-30)/30)+")",d++):i.fillStyle="white",i.font=" 48px score ",i.fillText("Score : "+k,.3*h.width,.3*h.height),i.fillText("BEST : "+localStorage.getItem("myPb"),.315*h.width,.5*h.height),r%40<20&&i.fillText("Click to restart",.15*h.width,.7*h.height),i.restore(),60===d&&(r=0,k=0,l=0,a=0,o=0,mt.readyVer=[0,1,2],mt.readyHor=[3,4,5],g=60,m=60,f=60,d=0,e.current=e.main),e.current===e.over&&(document.onclick=function(){d=30,p=!0});break}o--,o=Math.max(0,o),y++,y=Math.min(70,y),c++,c=Math.min(40,c),w++,w=Math.min(1,w),u--,u=Math.max(0,u),x++,x=Math.min(5,x),b++,b=Math.min(20,b),v--,v=Math.max(0,v),r++,t(s),i.restore()}()}();